#  Conceptos T茅cnicos

Comprende c贸mo funciona el algoritmo por debajo de la interfaz.

## Algoritmo Gen茅tico

### Qu茅 es

Un algoritmo de optimizaci贸n inspirado en la evoluci贸n natural de las especies.

### Analog铆a Biol贸gica

```
Poblaci贸n de rutas (cromosomas)
         Flecha baja
    Evaluaci贸n
  (medir fitness)
         Flecha baja
    Selecci贸n
 (los mejores se reproducen)
         Flecha baja
    Cruce y Mutaci贸n
  (crear variedad)
         Flecha baja
    Nueva Poblaci贸n
    (siguiente generaci贸n)
```

### Componentes del Sistema

#### Cromosoma (Ruta)

Cada soluci贸n es una permutaci贸n de paradas:

```
Cromosoma = [0, 3, 1, 4, 2, 5, 6]
             ^                 ^
    Punto de inicio    Punto final
    (fijo)             (fijo)
```

#### Poblaci贸n

Conjunto de rutas posibles con 100 individuos.

#### Fitness (Funci贸n Objetivo)

Mide qu茅 tan buena es cada ruta:

```
Menor distancia = MEJOR fitness
Ejemplo: 11,800m es mejor que 15,200m
```

---

## Operadores Gen茅ticos

### 1. Selecci贸n por Torneo (k=3)

Se eligen 3 rutas aleatorias, se comparan y se selecciona la mejor.

**Ventajas:**
- Simple y eficiente
- Equilibrio entre exploraci贸n
- No elimina diversidad

### 2. Cruce PMX (Partially Mapped Crossover)

Intercambia segmento intermedio sin duplicados.

### 3. Mutaci贸n por Intercambio

Con probabilidad del 15%, intercambia dos paradas intermedias.

### 4. Elitismo

Los 2 mejores pasan autom谩ticamente a la siguiente generaci贸n.

---

## Matriz de Distancias

### Qu茅 es

Tabla NxN donde cada celda contiene la distancia real entre dos puntos.

### C谩lculo de Fitness

Para la ruta [0, 3, 1, 4, 2, 5, 6]:

```
Distancia total = suma de todos los segmentos
= 800 + 1900 + 1100 + 1300 + 1500 + 800
= 7,200 metros
```

---

## Integraci贸n con OpenStreetMap

### Por qu茅 OSM

Proporciona distancias reales siguiendo calles, no l铆neas rectas.

### Proceso de Geocodificaci贸n

1. Buscar en base de datos exacta
2. Si no: Geocodificar con Nominatim
3. Si falla: Fallback euclidiano multiplicado por 1.3

---

## An谩lisis Autom谩tico con Google Gemini (NUEVO v2.0)

### Qu茅 es

Sistema de inteligencia artificial que analiza autom谩ticamente los resultados del algoritmo gen茅tico.

### Integraci贸n Google Gemini

Google Gemini 2.0 Flash es un modelo de lenguaje grande de Google que puede:

- Analizar datos complejos de optimizaci贸n
- Generar explicaciones en lenguaje natural
- Proporcionar recomendaciones basadas en IA
- Producir documentaci贸n autom谩tica

### Flujo de An谩lisis

1. **Usuario solicita an谩lisis** desde el panel de resultados
2. **Frontend env铆a datos** al backend con resultados del GA
3. **Backend construye prompt** con:
   - Informaci贸n de las rutas
   - Par谩metros del algoritmo usado
   - Historial de evoluci贸n del fitness
   - Estad铆sticas de mejora
4. **Llamada a Gemini** mediante Google API
5. **Procesamiento IA** genera an谩lisis completo
6. **Respuesta en Markdown** con:
   - Resumen ejecutivo
   - Explicaci贸n del algoritmo
   - An谩lisis de par谩metros
   - Recomendaciones de mejora
   - Conclusiones
7. **Modal interactivo** muestra an谩lisis formateado

### Ventajas de la Integraci贸n IA

| Ventaja | Descripci贸n |
|---------|-------------|
| **Automatizaci贸n** | No requiere an谩lisis manual |
| **Inteligencia** | Comprende contexto y mejora propuestas |
| **Explicabilidad** | Genera explicaciones claras del AG |
| **Documentaci贸n** | Crea reportes listos para usar |
| **Velocidad** | An谩lisis en 3-5 segundos |

### Especificaciones T茅cnicas

**Modelo:** `gemini-2.0-flash`

- Velocidad: ~1-3 segundos por an谩lisis
- Tokens: ~500-1000 tokens entrada/salida
- Disponibilidad: API Key requerida
- Coste: ~$0.10 USD por 1M tokens

### Ejemplo de Salida

```markdown
# An谩lisis de Optimizaci贸n - Ruta Central

## Resumen Ejecutivo
Se optimiz贸 la ruta central mejorando
la distancia en 15% (de 12.5km a 10.6km).

## Explicaci贸n del Algoritmo
Se utiliz贸 AG con poblaci贸n de 100...

## Recomendaciones
1. Considerar reordenamiento por horario
2. Validar paradas nuevas...
3. Monitorear cambios de tr谩fico...
```

### Limitaciones y Consideraciones

- Requiere conexi贸n a internet
- Depends on Google API availability
- Rate limiting: 60 req/min (free tier)
- API Key debe mantenerse segura
- Respuestas pueden variar por natura de IA

---

## Par谩metros del Algoritmo

### Configuraci贸n Actual

- Poblaci贸n: 100 individuos
- Generaciones: 200 iteraciones
- Tasa Cruce: 80 por ciento
- Tasa Mutaci贸n: 15 por ciento
- Elitismo: 2 mejores

### Convergencia

T铆picamente converge en generaci贸n 50-100 de 200.

---

**Siguiente paso**: [Troubleshooting](/troubleshooting)
